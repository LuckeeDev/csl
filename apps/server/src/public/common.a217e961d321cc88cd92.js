(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"8BM3":function(e,t,i){"use strict";i.d(t,"a",(function(){return G}));var o=i("D57K"),c=i("nIj0"),s=i("IdLP"),n=i("YtkY"),a=i("J+dc"),r=i("yDe4"),l=i("oIO+"),u=i("EM62"),d=i("sEIs"),b=i("fPML"),m=i("jxfh"),p=i("9ufM"),f=i("2kYt"),h=i("Meci"),g=i("FlRo"),v=i("29Wa"),C=i("S17y"),R=i("ulve"),D=i("bFHC"),w=i("mFH5"),I=i("PBFl"),V=i("Rjd2");const U=["roleInput"],F=["auto"];function y(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Email"),u.Ub())}function P(e,t){if(1&e&&(u.Vb(0,"mat-cell"),u.Fc(1),u.Ub()),2&e){const e=t.$implicit;u.Db(1),u.Gc(e.email)}}function O(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Ruoli"),u.Ub())}function T(e,t){if(1&e){const e=u.Wb();u.Vb(0,"mat-chip",20),u.cc("removed",(function(){u.uc(e);const i=t.$implicit,o=u.gc().$implicit;return u.gc(2).remove(i.role,o.email)})),u.Fc(1),u.Vb(2,"mat-icon",21),u.Fc(3,"cancel"),u.Ub(),u.Ub()}if(2&e){const e=t.$implicit;u.mc("selectable",!0)("removable",!0),u.Db(1),u.Hc(" ",e.description," ")}}function k(e,t){if(1&e&&(u.Vb(0,"mat-option",22),u.Fc(1),u.Ub()),2&e){const e=t.$implicit;u.mc("value",e.description),u.Db(1),u.Hc(" ",e.description," ")}}function S(e,t){if(1&e){const e=u.Wb();u.Vb(0,"mat-cell"),u.Vb(1,"mat-form-field",11),u.Vb(2,"mat-chip-list",12,13),u.Dc(4,T,4,3,"mat-chip",14),u.Qb(5,"input",15,16),u.Ub(),u.Vb(7,"mat-autocomplete",17,18),u.cc("optionSelected",(function(i){u.uc(e);const o=t.$implicit;return u.gc(2).selected(i,o.email,o.roles)})),u.Dc(9,k,2,2,"mat-option",19),u.hc(10,"async"),u.Ub(),u.Ub(),u.Ub()}if(2&e){const e=t.$implicit,i=u.sc(3),o=u.sc(8),c=u.gc(2);u.Db(4),u.mc("ngForOf",e.roles),u.Db(1),u.mc("formControl",c.roleCtrl)("matAutocomplete",o)("matChipInputFor",i),u.Db(4),u.mc("ngForOf",u.ic(10,5,c.filteredRoles))}}function M(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Credito"),u.Ub())}function A(e,t){if(1&e&&(u.Vb(0,"mat-cell"),u.Fc(1),u.hc(2,"currency"),u.Ub()),2&e){const e=t.$implicit;u.Db(1),u.Gc(u.jc(2,1,e.snackCredit,"EUR"))}}function E(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Gestisci"),u.Ub())}function L(e,t){1&e&&(u.Vb(0,"mat-cell"),u.Vb(1,"button",23),u.Fc(2," Aggiungi credito "),u.Ub(),u.Ub())}function j(e,t){1&e&&u.Qb(0,"mat-header-row")}function $(e,t){1&e&&u.Qb(0,"mat-row")}function _(e,t){if(1&e&&(u.Tb(0),u.Vb(1,"mat-card"),u.Vb(2,"mat-card-header"),u.Vb(3,"mat-card-title"),u.Fc(4),u.Ub(),u.Ub(),u.Vb(5,"mat-card-content"),u.Vb(6,"mat-table",2),u.Tb(7,3),u.Dc(8,y,2,0,"mat-header-cell",4),u.Dc(9,P,2,1,"mat-cell",5),u.Sb(),u.Tb(10,6),u.Dc(11,O,2,0,"mat-header-cell",4),u.Dc(12,S,11,7,"mat-cell",5),u.Sb(),u.Tb(13,7),u.Dc(14,M,2,0,"mat-header-cell",4),u.Dc(15,A,3,4,"mat-cell",5),u.Sb(),u.Tb(16,8),u.Dc(17,E,2,0,"mat-header-cell",4),u.Dc(18,L,3,0,"mat-cell",5),u.Sb(),u.Dc(19,j,1,0,"mat-header-row",9),u.Dc(20,$,1,0,"mat-row",10),u.Ub(),u.Ub(),u.Ub(),u.Sb()),2&e){const e=t.ngIf,i=u.gc();u.Db(4),u.Hc(" ",e.id.toUpperCase(),""),u.Db(2),u.mc("dataSource",e.members),u.Db(13),u.mc("matHeaderRowDef",i.displayedColumns),u.Db(1),u.mc("matRowDefColumns",i.displayedColumns)}}function x(e,t){1&e&&(u.Vb(0,"csl-alert",24),u.Fc(1," Non abbiamo trovato nessuna classe con questo ID! "),u.Ub())}let G=(()=>{class e{constructor(e,t,i,o,s,a){this.activated=e,this.members=t,this.toastr=i,this.auth=o,this.router=s,this.store=a,this.roleCtrl=new c.e,this.allRoles=[{description:"Rappresentante di classe",role:"isRappreDiClasse"},{description:"Direttore di QP",role:"isQp"},{description:"Referente Arte",role:"isReferente[arte]"},{description:"Referente ASL",role:"isReferente[asl]"},{description:"Referente Biblioteca",role:"isReferente[biblioteca]"},{description:"Referente Cinema",role:"isReferente[cinema]"},{description:"Referente Consulta",role:"isReferente[consulta]"},{description:"Referente Dibattito",role:"isReferente[dibattito]"},{description:"Referente Green",role:"isReferente[green]"},{description:"Referente Feste",role:"isReferente[feste]"},{description:"Referente LIR",role:"isReferente[lir]"},{description:"Referente Musica",role:"isReferente[musica]"},{description:"Referente Omnia",role:"isReferente[omnia]"},{description:"Referente PortArti",role:"isReferente[portarti]"},{description:"Referente Sport",role:"isReferente[sport]"},{description:"Referente Tutoring",role:"isReferente[tutoring]"},{description:"Referente VALE",role:"isReferente[vale]"}],this.router.url.includes("bar-admin")?this.displayedColumns=["email","credit","manage"]:this.router.url.includes("vice")?this.displayedColumns=["email"]:this.router.url.includes("rappre")?this.displayedColumns=["email","roles"]:this.router.url.includes("admin")&&(this.displayedColumns=["email","roles"],this.allRoles.push({role:"isRappre",description:"Rappresentante d'Istituto"},{role:"isBar",description:"Barista"},{role:"isVice",description:"Vice"})),this.filteredRoles=this.roleCtrl.valueChanges.pipe(Object(n.a)((e=>e?this._filter(e):this.allRoles.slice()))),this.classID=this.activated.snapshot.paramMap.get("classID")}ngOnInit(){this.state$.pipe(Object(a.a)(1)).subscribe((e=>{this.store.dispatch(e.classes?new l.b.GetCurrent(this.classID):new l.b.Get(this.classID))}))}selected(e,t,i){const o=e.option.viewValue,c=this.allRoles.find((e=>e.description===o));this.roleInput.nativeElement.value="",this.roleCtrl.setValue(null),i.find((e=>e.role===c.role))?this.toastr.show({message:"Questo utente ha gi\xe0 questo ruolo!",color:"accent"}):i.find((e=>e.role.includes("isReferente")))&&c.role.includes("isReferente")?this.toastr.showError("Impossibile aggiungere un altro ruolo da referente!"):this.store.dispatch(new l.c.Add(c,t)).subscribe((()=>{this.toastr.show({message:"Ruolo aggiunto a "+t,color:"success",action:"Chiudi",duration:5e3})}))}remove(e,t){this.store.dispatch(new l.c.Remove(e,t)).subscribe((()=>{this.toastr.show({message:"Ruolo rimosso da "+t,color:"accent"})}))}_filter(e){const t=e.toLowerCase();return this.allRoles.filter((e=>0===e.description.toLowerCase().indexOf(t)))}}return e.\u0275fac=function(t){return new(t||e)(u.Pb(d.a),u.Pb(b.a),u.Pb(m.b),u.Pb(p.a),u.Pb(d.f),u.Pb(r.e))},e.\u0275cmp=u.Jb({type:e,selectors:[["csl-single-class"]],viewQuery:function(e,t){var i;1&e&&(u.Kc(U,!0),u.Kc(F,!0)),2&e&&(u.rc(i=u.dc())&&(t.roleInput=i.first),u.rc(i=u.dc())&&(t.matAutocomplete=i.first))},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["noClassFound",""],[3,"dataSource"],["matColumnDef","email"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","roles"],["matColumnDef","credit"],["matColumnDef","manage"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"chip-list"],["aria-label","Fruit selection"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","Ruoli...",3,"formControl","matAutocomplete","matChipInputFor"],["roleInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"selectable","removable","removed"],["matChipRemove",""],[3,"value"],["mat-button","","color","primary"],["color","primary"]],template:function(e,t){if(1&e&&(u.Dc(0,_,21,4,"ng-container",0),u.hc(1,"async"),u.Dc(2,x,2,0,"ng-template",null,1,u.Ec)),2&e){const e=u.sc(3);u.mc("ngIf",u.ic(1,2,t.state$).currentClass)("ngIfElse",e)}},directives:[f.m,h.a,h.e,h.h,h.d,g.j,g.c,g.e,g.b,g.g,g.i,g.d,g.a,v.b,C.c,f.l,c.b,R.c,C.b,c.o,c.f,R.a,C.a,D.a,C.d,w.i,I.b,g.f,g.h,V.a],pipes:[f.b,f.d],styles:[".chip-list[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%}"]}),Object(o.__decorate)([Object(r.c)(l.a),Object(o.__metadata)("design:type",s.a)],e.prototype,"state$",void 0),e})()},CAI7:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var o=i("DY2v"),c=i("+IuD"),s=i.n(c),n=i("w/LV"),a=i.n(n),r=i("6V5p"),l=i.n(r),u=i("UIvY"),d=i.n(u),b=i("eVdK"),m=i.n(b),p=i("jxfh"),f=i("9ufM"),h=i("YtkY"),g=i("TLy2"),v=i("EM62"),C=i("sEIs"),R=i("Meci"),D=i("PBFl");let w=(()=>{class e{constructor(e,t,i,o,c){this.commissioni=e,this.dialog=t,this.toastr=i,this.auth=o,this.router=c}ngOnInit(){}ngAfterViewInit(){this.auth.user$.pipe(Object(h.a)((e=>this.router.url.includes("rappre")&&e.isRappre?"comitato":this.router.url.includes("referente")?e.isReferente:void 0)),Object(g.a)((e=>(this.commissione=e,this.commissioni.getPage(this.commissione))))).subscribe((e=>{const t=e.data;this.editor=new s.a({holder:"editorjs",data:t.page?t.page:null,tools:{header:{class:a.a,shortcut:"CTRL+ALT+T",inlineToolbar:!0,config:{placeholder:"Titolo",levels:[1,2,3],defaultLevel:1}},paragraph:{class:l.a,shortcut:"CTRL+ALT+Q",inlineToolbar:!0,config:{placeholder:"Paragrafo"}},list:{class:d.a,inlineToolbar:!0,shortcut:"CTRL+ALT+W"},image:{class:m.a,shortcut:"CTRL+ALT+I",inlineToolbar:!0,config:{endpoints:{byFile:`/api/commissioni/${this.commissione}/image`}}}},i18n:{messages:{toolNames:{Text:"Paragrafo",Heading:"Titolo",List:"Elenco",Image:"Immagine",Bold:"Grassetto",Italic:"Corsivo"},tools:{list:{Ordered:"Numerato",Unordered:"Non numerato"},image:{"Select an Image":"Carica un'immagine","With border":"Con bordo","Stretch image":"Allarga immagine","With background":"Con sfondo"},link:{"Add a link":"Aggiungi un link"}},blockTunes:{delete:{Delete:"Elimina"},moveUp:{"Move up":"Sposta su"},moveDown:{"Move down":"Sposta gi\xf9"}},ui:{blockTunes:{toggler:{"Click to tune":"Modifica"}},inlineToolbar:{converter:{"Convert to":"Converti in"}},toolbar:{toolbox:{Add:"Aggiungi"}}}}},defaultBlock:"paragraph",autofocus:!0})}))}save(){this.dialog.open({title:"Salvare pagina?",text:"Potrai tornare quando vorrai per modificarla",answer:"Salva",color:"primary"}).subscribe((()=>{this.editor.save().then((e=>{this.commissioni.savePage(this.commissione,e).subscribe((e=>{e.success?this.toastr.show({color:"success",message:"Pagina salvata"}):this.toastr.showError()}))}))}))}}return e.\u0275fac=function(t){return new(t||e)(v.Pb(o.a),v.Pb(p.a),v.Pb(p.b),v.Pb(f.a),v.Pb(C.f))},e.\u0275cmp=v.Jb({type:e,selectors:[["csl-editor"]],decls:9,vars:0,consts:[["id","editorjs"],[1,"actions"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(v.Vb(0,"mat-card"),v.Vb(1,"mat-card-header"),v.Vb(2,"mat-card-title"),v.Fc(3,"Gestisci la pagina della tua Commissione"),v.Ub(),v.Ub(),v.Vb(4,"mat-card-content"),v.Qb(5,"div",0),v.Ub(),v.Vb(6,"mat-card-actions",1),v.Vb(7,"button",2),v.cc("click",(function(){return t.save()})),v.Fc(8," Salva pagina "),v.Ub(),v.Ub(),v.Ub())},directives:[R.a,R.e,R.h,R.d,R.b,D.b],styles:[".actions[_ngcontent-%COMP%]{margin-left:20px;margin-top:10px}"]}),e})()},r8jD:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var o=i("D57K"),c=i("yDe4"),s=i("oIO+"),n=i("IdLP"),a=i("EM62"),r=i("2kYt"),l=i("Meci"),u=i("sEIs"),d=i("Rjd2");const b=function(e){return[e]};function m(e,t){if(1&e&&(a.Tb(0),a.Vb(1,"mat-card",5),a.Vb(2,"mat-card-header"),a.Vb(3,"mat-card-title"),a.Fc(4),a.Ub(),a.Ub(),a.Ub(),a.Sb()),2&e){const e=t.$implicit;a.Db(1),a.mc("routerLink",a.pc(2,b,e.id)),a.Db(3),a.Gc(e.id.toUpperCase())}}function p(e,t){if(1&e&&(a.Tb(0),a.Dc(1,m,5,4,"ng-container",4),a.Sb()),2&e){const e=a.gc().ngIf;a.Db(1),a.mc("ngForOf",e)}}function f(e,t){if(1&e&&(a.Vb(0,"div",2),a.Dc(1,p,2,1,"ng-container",3),a.Ub()),2&e){const e=t.ngIf;a.gc();const i=a.sc(3);a.Db(1),a.mc("ngIf",e.length>0)("ngIfElse",i)}}function h(e,t){1&e&&(a.Vb(0,"csl-alert",6),a.Fc(1," Non ci sono ancora classi! "),a.Ub())}let g=(()=>{class e{constructor(e){this.store=e}ngOnInit(){this.store.dispatch(new s.b.Get)}}return e.\u0275fac=function(t){return new(t||e)(a.Pb(c.e))},e.\u0275cmp=a.Jb({type:e,selectors:[["app-classi"]],decls:4,vars:4,consts:[["class","cards",4,"ngIf","ngIfElse"],["noClasses",""],[1,"cards"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[1,"card",3,"routerLink"],["color","primary",1,"alert"]],template:function(e,t){if(1&e&&(a.Dc(0,f,2,2,"div",0),a.hc(1,"async"),a.Dc(2,h,2,0,"ng-template",null,1,a.Ec)),2&e){const e=a.sc(3);a.mc("ngIf",a.ic(1,2,t.state$).classes)("ngIfElse",e)}},directives:[r.m,r.l,l.a,u.g,l.e,l.h,d.a],pipes:[r.b],styles:[".cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.card[_ngcontent-%COMP%]{cursor:pointer;margin-right:20px;outline:none}.alert[_ngcontent-%COMP%]{width:100%}"]}),Object(o.__decorate)([Object(c.c)(s.a),Object(o.__metadata)("design:type",n.a)],e.prototype,"state$",void 0),e})()},zlwK:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i("JCQO"),c=i("jxfh"),s=i("EM62"),n=i("PBFl"),a=i("2kYt");function r(e,t){if(1&e){const e=s.Wb();s.Vb(0,"div"),s.Vb(1,"p"),s.Fc(2),s.Ub(),s.Vb(3,"button",4),s.cc("click",(function(){s.uc(e);const t=s.gc();return t.uploadCsv(t.upload.csvFile.name)})),s.Fc(4," Carica "),s.Ub(),s.Ub()}if(2&e){const e=s.gc();s.Db(2),s.Hc('Nome del file caricato: "',e.upload.csvFile.name,'"')}}let l=(()=>{class e{constructor(e,t,i){this.upload=e,this.dialog=t,this.toastr=i}ngOnInit(){}uploadCsv(e){this.dialog.open({title:"Sei sicuro?",text:`Il file "${e}" verr\xe0 caricato e creer\xe0 gli account per gli studenti della scuola`,answer:"Conferma",color:"primary"}).subscribe((e=>{this.upload.onCsvUpload().subscribe((e=>{const{success:t,duplicates:i}=e;!0===t?this.toastr.show({message:"Account creati",color:"success",action:"Chiudi",duration:5e3}):!1===t&&i&&(this.ref=this.toastr.show({message:"Mail duplicate trovate",color:"warn",action:"Copia email",duration:15e3}),this.ref.onAction().subscribe((()=>{window.navigator.clipboard.writeText(i.toString())})))}))}))}}return e.\u0275fac=function(t){return new(t||e)(s.Pb(o.a),s.Pb(c.a),s.Pb(c.b))},e.\u0275cmp=s.Jb({type:e,selectors:[["app-csv"]],decls:6,vars:1,consts:[["type","file",2,"display","none",3,"change"],["selectFile",""],["mat-stroked-button","","color","primary",3,"click"],[4,"ngIf"],["mat-raised-button","","color","primary","size","small",3,"click"]],template:function(e,t){if(1&e){const e=s.Wb();s.Vb(0,"div"),s.Vb(1,"input",0,1),s.cc("change",(function(e){return t.upload.onCsvSelect(e)})),s.Ub(),s.Vb(3,"button",2),s.cc("click",(function(){return s.uc(e),s.sc(2).click()})),s.Fc(4," Scegli file "),s.Ub(),s.Dc(5,r,5,1,"div",3),s.Ub()}2&e&&(s.Db(5),s.mc("ngIf",t.upload.readyToUploadCsv))},directives:[n.b,a.m],styles:["button[_ngcontent-%COMP%]{margin-bottom:20px}"]}),e})()}}]);