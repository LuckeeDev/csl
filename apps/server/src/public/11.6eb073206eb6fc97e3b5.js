(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+F6c":function(t,e,a){"use strict";a.r(e),a.d(e,"QpAdminModule",(function(){return Z}));var i=a("2kYt"),o=a("sEIs"),c=a("EM62"),r=a("3DyK");let n=(()=>{class t{constructor(){this.links=[{link:".",title:"Home"},{link:"editor",title:"Articoli"},{link:"guide",title:"Guida"}]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Jb({type:t,selectors:[["app-qp-admin"]],decls:3,vars:1,consts:[[3,"links"]],template:function(t,e){1&t&&(c.Vb(0,"csl-dashboard-model",0),c.Vb(1,"span"),c.Gc(2,"QP"),c.Ub(),c.Ub()),2&t&&c.mc("links",e.links)},directives:[r.a],styles:[""]}),t})();var s=a("9ufM"),l=a("jxfh"),b=a("SKMG"),u=a("PBFl");let m=(()=>{class t{constructor(t,e){this.dialog=t,this.auth=e}ngOnInit(){}signOut(){this.dialog.open({title:"Sei sicuro di voler uscire?",text:"Ci\xf2 che stavi facendo potrebbe non essere salvato",color:"warn",answer:"S\xec, esci"}).subscribe((t=>{this.auth.signOut()}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(l.a),c.Pb(s.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-qp-admin-home"]],decls:10,vars:3,consts:[[3,"user"],["header",""],["activities-label",""],["activities",""],["mat-raised-button","","color","warn","logout-btn","",3,"click"]],template:function(t,e){1&t&&(c.Vb(0,"csl-dashboard-home",0),c.hc(1,"async"),c.Vb(2,"span",1),c.Gc(3,"I vostri dati"),c.Ub(),c.Vb(4,"span",2),c.Gc(5,"Le vostre attivit\xe0"),c.Ub(),c.Vb(6,"span",3),c.Gc(7,"Questa sezione \xe8 ancora vuota! Tornate pi\xf9 tardi..."),c.Ub(),c.Vb(8,"button",4),c.cc("click",(function(){return e.signOut()})),c.Gc(9,"Esci"),c.Ub(),c.Ub()),2&t&&c.mc("user",c.ic(1,1,e.auth.user$))},directives:[b.a,u.b],pipes:[i.b],styles:[".profileimg[_ngcontent-%COMP%]{height:100%;border-radius:50px}h1[_ngcontent-%COMP%]{font-weight:500}mat-card[_ngcontent-%COMP%]{margin-bottom:20px}button[_ngcontent-%COMP%]{margin-top:20px}"]}),t})();var d=a("tPfK"),h=a("Meci"),p=a("FlRo"),g=a("k8N0");function f(t,e){1&t&&(c.Vb(0,"mat-header-cell"),c.Gc(1,"ID"),c.Ub())}function v(t,e){if(1&t&&(c.Vb(0,"mat-cell"),c.Gc(1),c.Ub()),2&t){const t=e.$implicit;c.Db(1),c.Hc(t.id)}}function C(t,e){1&t&&(c.Vb(0,"mat-header-cell"),c.Gc(1,"Titolo"),c.Ub())}function V(t,e){if(1&t&&(c.Vb(0,"mat-cell"),c.Gc(1),c.Ub()),2&t){const t=e.$implicit;c.Db(1),c.Hc(t.title)}}function w(t,e){1&t&&(c.Vb(0,"mat-header-cell"),c.Gc(1,"Pubblicato"),c.Ub())}function k(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-cell"),c.Vb(1,"mat-slide-toggle",10),c.cc("change",(function(a){c.vc(t);const i=e.$implicit;return c.gc().publishedChange(a,i.id)})),c.Ub(),c.Ub()}if(2&t){const t=e.$implicit;c.Db(1),c.mc("checked",t.published)}}function U(t,e){1&t&&(c.Vb(0,"mat-header-cell"),c.Gc(1,"Gestisci"),c.Ub())}const y=function(t){return[t]};function S(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-cell"),c.Vb(1,"button",11),c.Gc(2," Modifica "),c.Ub(),c.Vb(3,"button",12),c.cc("click",(function(){c.vc(t);const a=e.$implicit;return c.gc().deleteArticle(a.id)})),c.Gc(4," Elimina "),c.Ub(),c.Ub()}if(2&t){const t=e.$implicit;c.Db(1),c.mc("routerLink",c.pc(1,y,t.id))}}function D(t,e){1&t&&c.Qb(0,"mat-header-row")}function G(t,e){1&t&&c.Qb(0,"mat-row")}const T=function(){return["new"]};let P=(()=>{class t{constructor(t,e,a){this.articlesService=t,this.dialog=e,this.toastr=a,this.displayedColumns=["id","title","options","published"]}ngOnInit(){this.articlesService.getArticles().subscribe((t=>{this.articles=t.data}))}deleteArticle(t){this.dialog.open({title:"Cancellare l'articolo?",answer:"S\xec, cancella",text:"Non potrai pi\xf9 recuperarlo",color:"warn"}).subscribe((()=>{this.articlesService.delete(t).subscribe((t=>{!0===t.success?(this.toastr.show({message:"Articolo eliminato",color:"basic",action:"Chiudi",duration:5e3}),this.articlesService.getArticles().subscribe((t=>{this.articles=t.data}))):!1===t.success&&this.toastr.showError()}))}))}publishedChange(t,e){this.articlesService.changeArticlePublished(e,t.checked).subscribe((t=>{t.success?this.toastr.show({color:"basic",message:"Stato dell'articolo modificato con successo"}):this.toastr.showError()}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(d.a),c.Pb(l.a),c.Pb(l.b))},t.\u0275cmp=c.Jb({type:t,selectors:[["csl-manage-articles"]],decls:23,vars:5,consts:[[3,"dataSource"],["matColumnDef","id"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","title"],["matColumnDef","published"],["matColumnDef","options"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["mat-raised-button","","color","primary",3,"routerLink"],["color","primary",1,"toggle",3,"checked","change"],["mat-stroked-button","","color","primary","size","small",3,"routerLink"],["mat-stroked-button","","color","warn",3,"click"]],template:function(t,e){1&t&&(c.Vb(0,"mat-card"),c.Vb(1,"mat-card-header"),c.Vb(2,"mat-card-title"),c.Gc(3,"Articoli"),c.Ub(),c.Ub(),c.Vb(4,"mat-card-content"),c.Vb(5,"mat-table",0),c.Tb(6,1),c.Ec(7,f,2,0,"mat-header-cell",2),c.Ec(8,v,2,1,"mat-cell",3),c.Sb(),c.Tb(9,4),c.Ec(10,C,2,0,"mat-header-cell",2),c.Ec(11,V,2,1,"mat-cell",3),c.Sb(),c.Tb(12,5),c.Ec(13,w,2,0,"mat-header-cell",2),c.Ec(14,k,2,1,"mat-cell",3),c.Sb(),c.Tb(15,6),c.Ec(16,U,2,0,"mat-header-cell",2),c.Ec(17,S,5,3,"mat-cell",3),c.Sb(),c.Ec(18,D,1,0,"mat-header-row",7),c.Ec(19,G,1,0,"mat-row",8),c.Ub(),c.Ub(),c.Vb(20,"mat-card-actions"),c.Vb(21,"a",9),c.Gc(22," Aggiungi un articolo "),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Db(5),c.mc("dataSource",e.articles),c.Db(13),c.mc("matHeaderRowDef",e.displayedColumns),c.Db(1),c.mc("matRowDefColumns",e.displayedColumns),c.Db(2),c.mc("routerLink",c.oc(4,T)))},directives:[h.a,h.e,h.h,h.d,p.j,p.c,p.e,p.b,p.g,p.i,h.b,u.a,o.j,p.d,p.a,g.a,u.b,o.h,p.f,p.h],styles:["table[_ngcontent-%COMP%]{width:100%}button[_ngcontent-%COMP%]{margin-right:10px}mat-card-actions[_ngcontent-%COMP%]{margin-left:20px}.toggle[_ngcontent-%COMP%]{margin-left:10px}"]}),t})();var I=a("+IuD"),M=a.n(I),x=a("w/LV"),O=a.n(x),A=a("6V5p"),E=a.n(A),_=a("UIvY"),L=a.n(_),N=a("eVdK"),R=a.n(N),q=a("pkNS"),F=a.n(q),H=a("nIj0"),Q=a("2gE8"),$=a("29Wa"),j=a("R7+U"),z=a("Cd2c"),W=a("mFH5");function J(t,e){if(1&t&&(c.Vb(0,"mat-option",16),c.Gc(1),c.Ub()),2&t){const t=e.$implicit;c.mc("value",t),c.Db(1),c.Hc(t)}}let K=(()=>{class t{constructor(t,e,a,i,o,c,r){this.articlesService=t,this.dialog=e,this.toastr=a,this.route=i,this.router=o,this.fb=c,this.afs=r,this.metadata=this.fb.group({category:["",H.u.required],title:["",H.u.required],author:["",H.u.required],estimatedTime:["",H.u.required],image:["",H.u.required]}),this.ready=!1,this.articleID=this.route.snapshot.paramMap.get("articleID"),this.categories=["Lussana","Italia","Mondo","Speciale","Scienza & Tech","Cultura","Sport","Svago"]}ngOnInit(){}ngAfterViewInit(){this.articlesService.getArticle(this.articleID).subscribe((t=>{const e=t.data;e&&(this.metadata.controls.category.setValue(e.category),this.metadata.controls.title.setValue(e.title),this.metadata.controls.author.setValue(e.author),this.metadata.controls.estimatedTime.setValue(e.estimatedTime),this.metadata.controls.image.setValue(e.image)),this.editor=new M.a({holder:"editorjs",data:e?e.content:null,tools:{header:{class:O.a,shortcut:"CTRL+ALT+T",inlineToolbar:["bold","italic","hyperlink"],config:{placeholder:"Titolo",levels:[1,2,3],defaultLevel:1}},paragraph:{class:E.a,shortcut:"CTRL+ALT+Q",inlineToolbar:["bold","italic","hyperlink"],config:{placeholder:"Testo"}},list:{class:L.a,shortcut:"CTRL+ALT+W",inlineToolbar:["bold","italic","hyperlink"]},image:{class:R.a,shortcut:"CTRL+ALT+I",inlineToolbar:["bold","italic","hyperlink"],config:{endpoints:{byFile:"/api/articles/image"}}},hyperlink:{class:F.a,config:{availableTargets:["_blank","_self"],availableRels:["external"],target:"_blank",rel:"external"}}},defaultBlock:"paragraph",i18n:{messages:{toolNames:{Text:"Paragrafo",Heading:"Titolo",List:"Elenco",Image:"Immagine",Bold:"Grassetto",Italic:"Corsivo",Hyperlink:"Link"},tools:{list:{Ordered:"Numerato",Unordered:"Non numerato"},image:{"Select an Image":"Carica un'immagine","With border":"Con bordo","Stretch image":"Allarga immagine","With background":"Con sfondo"},link:{"Add a link":"Aggiungi un link"},hyperlink:{Save:"Salva","Select target":"Seleziona destinazione","Select rel":"Seleziona relazione"}},blockTunes:{delete:{Delete:"Elimina"},moveUp:{"Move up":"Sposta su"},moveDown:{"Move down":"Sposta gi\xf9"}},ui:{blockTunes:{toggler:{"Click to tune":"Modifica"}},inlineToolbar:{converter:{"Convert to":"Converti in"}},toolbar:{toolbox:{Add:"Aggiungi"}}}}},autofocus:!0,onReady:()=>{this.ready=!0}})}))}get originalImageName(){const t=this.metadata.value.image.split("_");return t.shift(),t.join("_")}save(){this.dialog.open({title:"Salvare l'articolo?",text:"Potrai comunque modificarlo in seguito",answer:"S\xec, salva",color:"primary"}).subscribe((()=>{this.editor.save().then((t=>{this.articlesService.save(t,this.metadata.value,this.articleID).subscribe((t=>{!0===t.success?(this.toastr.show({message:"Articolo salvato!",color:"success",action:"Chiudi",duration:5e3}),this.articleID||this.router.navigate(["editor",t.data.articleID],{relativeTo:this.route.parent})):!1===t.success&&this.toastr.showError()}))}))}))}delete(){this.dialog.open({title:"Cancellare l'articolo?",answer:"S\xec, cancella",text:"Non potrai pi\xf9 recuperarlo",color:"warn"}).subscribe((()=>{this.articleID?this.articleID&&this.articlesService.delete(this.articleID).subscribe((t=>{!0===t.success?(this.toastr.show({message:"Articolo eliminato",color:"basic",action:"Chiudi",duration:5e3}),this.router.navigate(["qp-admin","editor"])):!1===t.success&&this.toastr.showError()})):(this.editor.clear(),this.metadata.reset(),this.toastr.show({message:"Articolo eliminato",color:"basic"}),this.router.navigate(["..","qp-admin","editor"]))}))}uploadCover(t){const e=t.target.files[0],a=`${Date.now()}_${e.name}`;this.afs.ref("articles/covers/"+a).put(e).then((()=>{this.metadata.controls.image.setValue(a),this.toastr.show({message:"File caricato",color:"basic",action:"Chiudi",duration:5e3})})).catch((()=>{this.toastr.showError()}))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(d.a),c.Pb(l.a),c.Pb(l.b),c.Pb(o.a),c.Pb(o.g),c.Pb(H.d),c.Pb(Q.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["csl-editor"]],decls:44,vars:4,consts:[["id","editorjs"],[1,"form-container",3,"formGroup"],[1,"input"],["id","category","placeholder","Selezionare categoria...","formControlName","category"],[3,"value",4,"ngFor","ngForOf"],["matInput","","id","title","type","text","formControlName","title"],["matInput","","id","author","type","text","formControlName","author"],["id","estimatedTime","type","number","matInput","","formControlName","estimatedTime"],["matSuffix",""],[1,"break"],["type","file","hidden","",3,"change"],["uploadFile",""],["mat-stroked-button","","color","primary",3,"click"],[1,"file-text"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"],[3,"value"]],template:function(t,e){if(1&t){const t=c.Wb();c.Vb(0,"mat-card"),c.Vb(1,"mat-card-header"),c.Vb(2,"mat-card-title"),c.Gc(3,"Gestisci il tuo articolo"),c.Ub(),c.Ub(),c.Vb(4,"mat-card-content"),c.Vb(5,"h4"),c.Gc(6,"Contenuto"),c.Ub(),c.Qb(7,"div",0),c.Vb(8,"h4"),c.Gc(9,"Metadati"),c.Ub(),c.Vb(10,"form",1),c.Vb(11,"mat-form-field",2),c.Vb(12,"mat-label"),c.Gc(13,"Categoria"),c.Ub(),c.Vb(14,"mat-select",3),c.Ec(15,J,2,2,"mat-option",4),c.Ub(),c.Ub(),c.Vb(16,"mat-form-field",2),c.Vb(17,"mat-label"),c.Gc(18,"Titolo"),c.Ub(),c.Qb(19,"input",5),c.Ub(),c.Vb(20,"mat-form-field",2),c.Vb(21,"mat-label"),c.Gc(22,"Autore"),c.Ub(),c.Qb(23,"input",6),c.Ub(),c.Vb(24,"mat-form-field",2),c.Vb(25,"mat-label"),c.Gc(26,"Tempo stimato per la lettura"),c.Ub(),c.Qb(27,"input",7),c.Vb(28,"span",8),c.Gc(29,"minuti"),c.Ub(),c.Ub(),c.Qb(30,"div",9),c.Vb(31,"input",10,11),c.cc("change",(function(t){return e.uploadCover(t)})),c.Ub(),c.Vb(33,"button",12),c.cc("click",(function(){return c.vc(t),c.sc(32).click()})),c.Gc(34," Carica copertina "),c.Ub(),c.Vb(35,"p",13),c.Gc(36,"File caricato: "),c.Vb(37,"i"),c.Gc(38),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Vb(39,"mat-card-actions"),c.Vb(40,"button",14),c.cc("click",(function(){return e.save()})),c.Gc(41," Salva articolo "),c.Ub(),c.Vb(42,"button",15),c.cc("click",(function(){return e.delete()})),c.Gc(43," Cancella articolo "),c.Ub(),c.Ub(),c.Ub()}2&t&&(c.Db(10),c.mc("formGroup",e.metadata),c.Db(5),c.mc("ngForOf",e.categories),c.Db(23),c.Hc(e.originalImageName||"nessuno"),c.Db(2),c.mc("disabled",e.metadata.invalid))},directives:[h.a,h.e,h.h,h.d,H.v,H.p,H.i,$.b,$.f,j.a,H.o,H.g,i.l,z.a,H.b,H.r,$.g,u.b,h.b,W.i],styles:["mat-card[_ngcontent-%COMP%]{width:80%;margin-left:auto;margin-right:auto}h4[_ngcontent-%COMP%]{font-weight:500;flex:100%}mat-card-actions[_ngcontent-%COMP%], mat-card-content[_ngcontent-%COMP%]{margin-left:20px}.form-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.input[_ngcontent-%COMP%]{margin-right:10%;width:20%;min-width:180px;margin-bottom:20px}.break[_ngcontent-%COMP%]{flex-basis:100%;height:0}.file-text[_ngcontent-%COMP%]{margin-left:10px}"]}),t})();const B=[{path:"",component:n,children:[{path:"",component:m},{path:"editor",component:P},{path:"editor/new",component:K},{path:"editor/:articleID",component:K},{path:"guide",component:a("S2rc").a,data:{file:"qp-guide.md"}}]}];let Y=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},imports:[[o.k.forChild(B)],o.k]}),t})();var X=a("vrzs");let Z=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},imports:[[i.c,Y,l.c,H.k,H.s,X.a]]}),t})()}}]);