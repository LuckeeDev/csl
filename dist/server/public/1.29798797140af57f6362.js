(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"9EWH":function(e,t,r){"use strict";function n(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function i(e){return!!e&&!!e[W]}function s(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[K]||!!e.constructor[K]||l(e)||f(e))}function o(e,t,r){void 0===r&&(r=!1),0===a(e)?(r?Object.keys:X)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function a(e){var t=e[W];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:l(e)?2:f(e)?3:0}function c(e,t){return 2===a(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function u(e,t,r){var n=a(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function l(e){return L&&e instanceof Map}function f(e){return V&&e instanceof Set}function d(e){return e.o||e.t}function p(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=J(e);delete t[W];for(var r=X(t),n=0;n<r.length;n++){var i=r[n],s=t[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function b(e,t){h(e)||i(e)||!s(e)||(a(e)>1&&(e.set=e.add=e.clear=e.delete=m),Object.freeze(e),t&&o(e,(function(e,t){return b(t,!0)}),!0))}function m(){n(2)}function h(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function v(e){var t=Y[e];return t||n(19,e),t}function g(){return U}function y(e,t){t&&(v("Patches"),e.u=[],e.s=[],e.v=t)}function O(e){j(e),e.p.forEach(P),e.p=null}function j(e){e===U&&(U=e.l)}function R(e){return U={p:[],l:U,h:e,m:!0,_:0}}function P(e){var t=e[W];0===t.i||1===t.i?t.j():t.g=!0}function C(e,t){t._=t.p.length;var r=t.p[0],i=void 0!==e&&e!==r;return t.h.O||v("ES5").S(t,e,i),i?(r[W].P&&(O(t),n(4)),s(e)&&(e=_(t,e),t.l||S(t,e)),t.u&&v("Patches").M(r[W],e,t.u,t.s)):e=_(t,r,[]),O(t),t.u&&t.v(t.u,t.s),e!==G?e:void 0}function _(e,t,r){if(h(t))return t;var n=t[W];if(!n)return o(t,(function(i,s){return w(e,n,t,i,s,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return S(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=p(n.k):n.o;o(3===n.i?new Set(i):i,(function(t,s){return w(e,n,i,t,s,r)})),S(e,i,!1),r&&e.u&&v("Patches").R(n,r,e.u,e.s)}return n.o}function w(e,t,r,n,o,a){if(i(o)){var l=_(e,o,a&&t&&3!==t.i&&!c(t.D,n)?a.concat(n):void 0);if(u(r,n,l),!i(l))return;e.m=!1}if(s(o)&&!h(o)){if(!e.h.N&&e._<1)return;_(e,o),t&&t.A.l||S(e,o)}}function S(e,t,r){void 0===r&&(r=!1),e.h.N&&e.m&&b(t,r)}function A(e,t){var r=e[W];return(r?d(r):e)[t]}function D(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function I(e){e.P||(e.P=!0,e.l&&I(e.l))}function k(e){e.o||(e.o=p(e.t))}function F(e,t,r){var n=l(t)?v("MapSet").T(t,r):f(t)?v("MapSet").F(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:g(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,s=Q;r&&(i=[n],s=T);var o=Proxy.revocable(i,s),a=o.revoke,c=o.proxy;return n.k=c,n.j=a,c}(t,r):v("ES5").J(t,r);return(r?r.A:g()).p.push(n),n}function M(e){return i(e)||n(22,e),function e(t){if(!s(t))return t;var r,n=t[W],i=a(t);if(n){if(!n.P&&(n.i<4||!v("ES5").K(n)))return n.t;n.I=!0,r=E(t,i),n.I=!1}else r=E(t,i);return o(r,(function(t,i){n&&function(e,t){return 2===a(e)?e.get(t):e[t]}(n.t,t)===i||u(r,t,e(i))})),3===i?new Set(r):r}(e)}function E(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return p(e)}var x,U,N="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),L="undefined"!=typeof Map,V="undefined"!=typeof Set,z="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,G=N?Symbol.for("immer-nothing"):((x={})["immer-nothing"]=!0,x),K=N?Symbol.for("immer-draftable"):"__$immer_draftable",W=N?Symbol.for("immer-state"):"__$immer_state",X=("undefined"!=typeof Symbol&&Symbol,"undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames),J=Object.getOwnPropertyDescriptors||function(e){var t={};return X(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},Y={},Q={get:function(e,t){if(t===W)return e;var r=d(e);if(!c(r,t))return function(e,t,r){var n,i=D(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.k):void 0}(e,r,t);var n=r[t];return e.I||!s(n)?n:n===A(e.t,t)?(k(e),e.o[t]=F(e.A.h,n,e)):n},has:function(e,t){return t in d(e)},ownKeys:function(e){return Reflect.ownKeys(d(e))},set:function(e,t,r){var n=D(d(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=A(d(e),t),s=null==i?void 0:i[W];if(s&&s.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(r,i)&&(void 0!==r||c(e.t,t)))return!0;k(e),I(e)}return e.o[t]=r,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==A(e.t,t)||t in e.t?(e.D[t]=!1,k(e),I(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=d(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){n(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){n(12)}},T={};o(Q,(function(e,t){T[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),T.deleteProperty=function(e,t){return Q.deleteProperty.call(this,e[0],t)},T.set=function(e,t,r){return Q.set.call(this,e[0],t,r,e[0])};var Z=new(function(){function e(e){this.O=z,this.N=!1,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,r){if("function"==typeof e&&"function"!=typeof t){var i=t;t=e;var o=this;return function(e){var r=this;void 0===e&&(e=i);for(var n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return o.produce(e,(function(e){var n;return(n=t).call.apply(n,[r,e].concat(s))}))}}var a;if("function"!=typeof t&&n(6),void 0!==r&&"function"!=typeof r&&n(7),s(e)){var c=R(this),u=F(this,e,void 0),l=!0;try{a=t(u),l=!1}finally{l?O(c):j(c)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return y(c,r),C(e,c)}),(function(e){throw O(c),e})):(y(c,r),C(a,c))}if(!e||"object"!=typeof e){if((a=t(e))===G)return;return void 0===a&&(a=e),this.N&&b(a,!0),a}n(21,e)},t.produceWithPatches=function(e,t){var r,n,i=this;return"function"==typeof e?function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return i.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(n))}))}:[this.produce(e,t,(function(e,t){r=e,n=t})),r,n]},t.createDraft=function(e){s(e)||n(8),i(e)&&(e=M(e));var t=R(this),r=F(this,e,void 0);return r[W].C=!0,j(t),r},t.finishDraft=function(e,t){var r=(e&&e[W]).A;return y(r,t),C(void 0,r)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!z&&n(20),this.O=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}var s=v("Patches").$;return i(e)?s(e,t):this.produce(e,(function(e){return s(e,t.slice(r+1))}))},e}()),$=Z.produce;Z.produceWithPatches.bind(Z),Z.setAutoFreeze.bind(Z),Z.setUseProxies.bind(Z),Z.applyPatches.bind(Z),Z.createDraft.bind(Z),Z.finishDraft.bind(Z),t.a=$},JCQO:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("D57K"),i=r("8j5Y"),s=r("EM62"),o=r("vobO"),a=r("2gE8");let c=(()=>{class e{constructor(e,t){this.http=e,this.storage=t,this.imgFiles=[],this.sizes=["XXS","XS","S","M","L","XL","XXL"]}onCsvSelect(e){1===e.target.files.length&&(this.csvFile=e.target.files[0],this.readyToUploadCsv=!0)}onCsvUpload(){this.working=!0;const e=new FormData;return e.append("viceCsv",this.csvFile),this.http.post("/api/upload/csv",e).pipe(Object(i.a)((e=>{this.readyToUploadCsv=!1,this.csvFile=null,this.working=!1})))}onImgSelect(e){const t=e.target.files;for(let r of t)this.imgFiles.push(r);this.readyToUploadImages=!0}productUpload(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function*(){this.working=!0;const{name:n,description:i,price:s,colors:o,sizes:a}=e,c=[],u=n.toLowerCase().replace(/ /g,"-"),l=this.imgFiles,f=l.map((e=>e.name));if("gadgets"===t){const e=Object.entries(a);for(let[t,r]of e)!0===r&&c.push(t)}const d=l.map((e=>this.storage.upload("gadgets"===t?"gadgetImages/raw/"+e.name:"photoImages/raw/"+e.name,e)));yield Promise.all(d),"gadgets"===t?this.http.post("/api/products/create-gadgets",{id:u,name:n,description:i,price:s,category:t,fileNames:f,colors:o,sizes:c}).subscribe(r):"photos"===t&&this.http.post("/api/products/create-photos",{id:u,name:n,description:i,price:s,category:t,fileNames:f}).subscribe(r)}))}}return e.\u0275fac=function(t){return new(t||e)(s.Zb(o.b),s.Zb(a.a))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac}),e})()},PCNd:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("2kYt"),i=r("sEIs"),s=r("nIj0"),o=r("yDe4"),a=r("oIO+"),c=r("jxfh"),u=r("vrzs"),l=r("fPML"),f=r("JCQO"),d=r("EM62");let p=(()=>{class e{}return e.\u0275mod=d.Nb({type:e}),e.\u0275inj=d.Mb({factory:function(t){return new(t||e)},providers:[l.a,f.a],imports:[[n.c,i.j,s.s,c.c,u.a,o.b.forFeature([a.a])]]}),e})()},SKMG:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("EM62"),i=r("2kYt"),s=r("Rjd2"),o=r("Meci");function a(e,t){if(1&e&&(n.Vb(0,"mat-card",3),n.Vb(1,"mat-card-header"),n.Vb(2,"div",4),n.Qb(3,"img",5),n.Ub(),n.Vb(4,"mat-card-title"),n.Fc(5),n.Ub(),n.Vb(6,"mat-card-subtitle"),n.Fc(7),n.Ub(),n.Ub(),n.Ub()),2&e){const e=n.gc();n.Db(3),n.mc("src",e.user.photoURL,n.wc),n.Db(2),n.Ic("",e.user.firstName," ",e.user.lastName,""),n.Db(2),n.Gc(e.user.email)}}const c=[[["","header",""]],[["","activities-label",""]],[["","activities",""]],[["","logout-btn",""]]],u=["[header]","[activities-label]","[activities]","[logout-btn]"];let l=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Jb({type:e,selectors:[["csl-dashboard-home"]],inputs:{user:"user"},ngContentSelectors:u,decls:10,vars:1,consts:[[1,"header"],["class","user",4,"ngIf"],[1,"logout-btn"],[1,"user"],["mat-card-avatar",""],[1,"profileimg",3,"src"]],template:function(e,t){1&e&&(n.lc(c),n.Vb(0,"div"),n.Vb(1,"h1",0),n.kc(2),n.Ub(),n.Dc(3,a,8,4,"mat-card",1),n.Vb(4,"h1",0),n.kc(5,1),n.Ub(),n.Vb(6,"csl-alert"),n.kc(7,2),n.Ub(),n.Vb(8,"div",2),n.kc(9,3),n.Ub(),n.Ub()),2&e&&(n.Db(3),n.mc("ngIf",t.user))},directives:[i.m,s.a,o.a,o.e,o.c,o.h,o.g],styles:[".profileimg[_ngcontent-%COMP%]{height:100%;border-radius:50px}.header[_ngcontent-%COMP%]{font-weight:500}.user[_ngcontent-%COMP%]{margin-bottom:20px}.logout-btn[_ngcontent-%COMP%]{margin-top:20px}"]}),e})()},fPML:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("YtkY"),i=r("8j5Y"),s=r("EM62"),o=r("vobO");let a=(()=>{class e{constructor(e){this.http=e}getClasses(){return this.http.get("/api/users").pipe(Object(n.a)((e=>e.sort(((e,t)=>{const r=e.id.charAt(0).toString(),n=t.id.charAt(0).toString(),i=e.id.charCodeAt(1).toString(),s=t.id.charCodeAt(1).toString();return Number(r+i)-Number(n+s)})))))}getCurrentClass(e){if(this.classes){const t=this.classes.find((t=>t.id==e));t.members.sort(((e,t)=>e.email<t.email?-1:e.email>t.email?1:0)),this.currentClass=t}else this.http.get("/api/users").subscribe((t=>{this.classes=t.sort(((e,t)=>{const r=e.id.charAt(0).toString(),n=t.id.charAt(0).toString(),i=e.id.charCodeAt(1).toString(),s=t.id.charCodeAt(1).toString();return Number(r+i)-Number(n+s)}));const r=this.classes.find((t=>t.id==e));r.members.sort(((e,t)=>e.email<t.email?-1:e.email>t.email?1:0)),this.currentClass=r}))}getRoles(e,t){this.http.post("/api/users/getroles",{email:e}).subscribe(t)}addRole(e,t){return this.http.post("/api/users/addrole",{email:e,role:t})}removeRole(e,t){return this.http.post("/api/users/removerole",{email:e,role:t})}updateCredit(e,t){return this.http.patch("/api/users/manage/credit/"+e,{money:t}).pipe(Object(i.a)((r=>{if(!0===r.success){const r=this.currentClass.members.find((t=>t.email===e)),n=this.currentClass.members.indexOf(r);this.currentClass.members[n]={email:e,snackCredit:r.snackCredit+t}}})))}}return e.\u0275fac=function(t){return new(t||e)(s.Zb(o.b))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac}),e})()},"oIO+":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return f}));var n,i,s=r("D57K"),o=r("yDe4"),a=r("fPML"),c=r("9EWH"),u=r("jxfh"),l=r("EM62");!function(e){class t{constructor(e){this.classID=e}}t.type="[Classes] Get",e.Get=t;class r{constructor(e){this.classID=e}}r.type="[Classes] Get Current",e.GetCurrent=r}(n||(n={})),function(e){class t{constructor(e,t){this.role=e,this.email=t}}t.type="[Roles] Add",e.Add=t;class r{constructor(e,t){this.role=e,this.email=t}}r.type="[Roles] Remove",e.Remove=r}(i||(i={}));let f=(()=>{let e=class{constructor(e,t){this.members=e,this.toastr=t}getClasses(e,t){this.members.getClasses().subscribe((r=>{if(t.classID){const n=r.find((e=>e.id===t.classID));n.members=n.members.map((e=>(e.roles&&(e.roles=e.roles.map((e=>this.transformRole(e)))),e))),e.setState({classes:r,currentClass:n})}else e.setState({classes:r,currentClass:null})}))}getCurrentClass(e,t){return e.setState(Object(c.a)(e.getState(),(e=>{const r=e.classes.find((e=>e.id===t.classID));r.members=r.members.map((e=>(e.roles&&(e.roles=e.roles.map((e=>this.transformRole(e)))),e))),e.currentClass=r})))}addRole(e,t){this.members.addRole(t.email,t.role.role).subscribe((r=>{!0===r.success?e.setState(Object(c.a)(e.getState(),(e=>{const r=e.currentClass.members.findIndex((e=>e.email===t.email));e.currentClass.members[r].roles.push(t.role)}))):this.toastr.showError()}))}removeRole(e,t){this.members.removeRole(t.email,t.role).subscribe((r=>{!0===r.success?e.setState(Object(c.a)(e.getState(),(e=>{const r=e.currentClass.members.findIndex((e=>e.email===t.email)),n=e.currentClass.members[r].roles.findIndex((e=>e.role===t.role));e.currentClass.members[r].roles.splice(n,1)}))):this.toastr.showError()}))}transformRole(e){switch(e){case"isVice":return{role:e,description:"Vice"};case"isQp":return{role:e,description:"Direttore di QP"};case"isRappre":return{role:e,description:"Rappresentante d'istituto"};case"isRappreDiClasse":return{role:e,description:"Rappresentante di classe"};case"isReferente[arte]":return{role:e,description:"Referente Arte"};case"isReferente[asl]":return{role:e,description:"Referente ASL"};case"isReferente[biblioteca]":return{role:e,description:"Referente Biblioteca"};case"isReferente[cinema]":return{role:e,description:"Referente Cinema"};case"isReferente[consulta]":return{role:e,description:"Referente Consulta"};case"isReferente[dibattito]":return{role:e,description:"Referente Dibattito"};case"isReferente[feste]":return{role:e,description:"Referente Feste"};case"isReferente[green]":return{role:e,description:"Referente Green"};case"isReferente[lir]":return{role:e,description:"Referente LIR"};case"isReferente[musica]":return{role:e,description:"Referente Musica"};case"isReferente[omnia]":return{role:e,description:"Referente Omnia"};case"isReferente[portarti]":return{role:e,description:"Referente PortArti"};case"isReferente[sport]":return{role:e,description:"Referente Sport"};case"isReferente[tutoring]":return{role:e,description:"Referente Tutoring"};case"isReferente[vale]":return{role:e,description:"Referente VALE"}}}};return e.\u0275fac=function(t){return new(t||e)(l.Zb(a.a),l.Zb(u.b))},e.\u0275prov=l.Lb({token:e,factory:e.\u0275fac}),Object(s.__decorate)([Object(o.a)(n.Get),Object(s.__metadata)("design:type",Function),Object(s.__metadata)("design:paramtypes",[Object,n.Get]),Object(s.__metadata)("design:returntype",void 0)],e.prototype,"getClasses",null),Object(s.__decorate)([Object(o.a)(n.GetCurrent),Object(s.__metadata)("design:type",Function),Object(s.__metadata)("design:paramtypes",[Object,n.GetCurrent]),Object(s.__metadata)("design:returntype",void 0)],e.prototype,"getCurrentClass",null),Object(s.__decorate)([Object(o.a)(i.Add),Object(s.__metadata)("design:type",Function),Object(s.__metadata)("design:paramtypes",[Object,i.Add]),Object(s.__metadata)("design:returntype",void 0)],e.prototype,"addRole",null),Object(s.__decorate)([Object(o.a)(i.Remove),Object(s.__metadata)("design:type",Function),Object(s.__metadata)("design:paramtypes",[Object,i.Remove]),Object(s.__metadata)("design:returntype",void 0)],e.prototype,"removeRole",null),e=Object(s.__decorate)([Object(o.d)({name:"class"})],e),e})()}}]);