(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"8BM3":function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var o=i("D57K"),c=i("nIj0"),a=i("IdLP"),s=i("YtkY"),r=i("J+dc"),n=i("yDe4"),l=i("oIO+"),u=i("EM62"),d=i("sEIs"),b=i("fPML"),m=i("jxfh"),p=i("9ufM"),f=i("2kYt"),h=i("Meci"),g=i("FlRo"),v=i("29Wa"),C=i("S17y"),D=i("ulve"),R=i("bFHC"),w=i("mFH5"),I=i("PBFl");const V=["roleInput"],U=["auto"];function F(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Email"),u.Ub())}function y(e,t){if(1&e&&(u.Vb(0,"mat-cell"),u.Fc(1),u.Ub()),2&e){const e=t.$implicit;u.Db(1),u.Gc(e.email)}}function P(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Ruoli"),u.Ub())}function O(e,t){if(1&e){const e=u.Wb();u.Vb(0,"mat-chip",19),u.cc("removed",(function(){u.uc(e);const i=t.$implicit,o=u.gc().$implicit;return u.gc(2).remove(i.role,o.email)})),u.Fc(1),u.Vb(2,"mat-icon",20),u.Fc(3,"cancel"),u.Ub(),u.Ub()}if(2&e){const e=t.$implicit;u.mc("selectable",!0)("removable",!0),u.Db(1),u.Hc(" ",e.description," ")}}function T(e,t){if(1&e&&(u.Vb(0,"mat-option",21),u.Fc(1),u.Ub()),2&e){const e=t.$implicit;u.mc("value",e.description),u.Db(1),u.Hc(" ",e.description," ")}}function k(e,t){if(1&e){const e=u.Wb();u.Vb(0,"mat-cell"),u.Vb(1,"mat-form-field",10),u.Vb(2,"mat-chip-list",11,12),u.Dc(4,O,4,3,"mat-chip",13),u.Qb(5,"input",14,15),u.Ub(),u.Vb(7,"mat-autocomplete",16,17),u.cc("optionSelected",(function(i){u.uc(e);const o=t.$implicit;return u.gc(2).selected(i,o.email,o.roles)})),u.Dc(9,T,2,2,"mat-option",18),u.hc(10,"async"),u.Ub(),u.Ub(),u.Ub()}if(2&e){const e=t.$implicit,i=u.sc(3),o=u.sc(8),c=u.gc(2);u.Db(4),u.mc("ngForOf",e.roles),u.Db(1),u.mc("formControl",c.roleCtrl)("matAutocomplete",o)("matChipInputFor",i),u.Db(4),u.mc("ngForOf",u.ic(10,5,c.filteredRoles))}}function S(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Credito"),u.Ub())}function A(e,t){if(1&e&&(u.Vb(0,"mat-cell"),u.Fc(1),u.hc(2,"currency"),u.Ub()),2&e){const e=t.$implicit;u.Db(1),u.Gc(u.jc(2,1,e.snackCredit,"EUR"))}}function L(e,t){1&e&&(u.Vb(0,"mat-header-cell"),u.Fc(1,"Gestisci"),u.Ub())}function M(e,t){1&e&&(u.Vb(0,"mat-cell"),u.Vb(1,"button",22),u.Fc(2," Aggiungi credito "),u.Ub(),u.Ub())}function j(e,t){1&e&&u.Qb(0,"mat-header-row")}function E(e,t){1&e&&u.Qb(0,"mat-row")}function $(e,t){if(1&e&&(u.Tb(0),u.Vb(1,"mat-card"),u.Vb(2,"mat-card-header"),u.Vb(3,"mat-card-title"),u.Fc(4),u.Ub(),u.Ub(),u.Vb(5,"mat-card-content"),u.Vb(6,"mat-table",1),u.Tb(7,2),u.Dc(8,F,2,0,"mat-header-cell",3),u.Dc(9,y,2,1,"mat-cell",4),u.Sb(),u.Tb(10,5),u.Dc(11,P,2,0,"mat-header-cell",3),u.Dc(12,k,11,7,"mat-cell",4),u.Sb(),u.Tb(13,6),u.Dc(14,S,2,0,"mat-header-cell",3),u.Dc(15,A,3,4,"mat-cell",4),u.Sb(),u.Tb(16,7),u.Dc(17,L,2,0,"mat-header-cell",3),u.Dc(18,M,3,0,"mat-cell",4),u.Sb(),u.Dc(19,j,1,0,"mat-header-row",8),u.Dc(20,E,1,0,"mat-row",9),u.Ub(),u.Ub(),u.Ub(),u.Sb()),2&e){const e=t.ngIf,i=u.gc();u.Db(4),u.Hc(" ",e.id,""),u.Db(2),u.mc("dataSource",e.members),u.Db(13),u.mc("matHeaderRowDef",i.displayedColumns),u.Db(1),u.mc("matRowDefColumns",i.displayedColumns)}}let _=(()=>{class e{constructor(e,t,i,o,a,r){this.activated=e,this.members=t,this.toastr=i,this.auth=o,this.router=a,this.store=r,this.roleCtrl=new c.e,this.allRoles=[{description:"Rappresentante di classe",role:"isRappreDiClasse"},{description:"Direttore di QP",role:"isQp"},{description:"Referente Arte",role:"isReferente[arte]"},{description:"Referente ASL",role:"isReferente[asl]"},{description:"Referente Biblioteca",role:"isReferente[biblioteca]"},{description:"Referente Cinema",role:"isReferente[cinema]"},{description:"Referente Consulta",role:"isReferente[consulta]"},{description:"Referente Dibattito",role:"isReferente[dibattito]"},{description:"Referente Green",role:"isReferente[green]"},{description:"Referente Feste",role:"isReferente[feste]"},{description:"Referente LIR",role:"isReferente[lir]"},{description:"Referente Musica",role:"isReferente[musica]"},{description:"Referente Omnia",role:"isReferente[omnia]"},{description:"Referente PortArti",role:"isReferente[portarti]"},{description:"Referente Sport",role:"isReferente[sport]"},{description:"Referente Tutoring",role:"isReferente[tutoring]"},{description:"Referente VALE",role:"isReferente[vale]"}],this.filteredRoles=this.roleCtrl.valueChanges.pipe(Object(s.a)((e=>e?this._filter(e):this.allRoles.slice()))),this.classID=this.activated.snapshot.paramMap.get("classID"),this.router.url.includes("bar-admin")?this.displayedColumns=["email","credit","manage"]:this.router.url.includes("vice")?this.displayedColumns=["email"]:(this.router.url.includes("rappre")||this.router.url.includes("admin"))&&(this.displayedColumns=["email","roles"])}ngOnInit(){this.state$.pipe(Object(r.a)(1)).subscribe((e=>{this.store.dispatch(e.classes?new l.b.GetCurrent(this.classID):new l.b.Get(this.classID))}))}selected(e,t,i){const o=e.option.viewValue,c=this.allRoles.find((e=>e.description===o));this.roleInput.nativeElement.value="",this.roleCtrl.setValue(null),i.find((e=>e.role===c.role))?this.toastr.show({message:"Questo utente ha gi\xe0 questo ruolo!",color:"accent"}):i.find((e=>e.role.includes("isReferente")))?this.toastr.showError("Impossibile aggiungere un altro ruolo da referente!"):this.store.dispatch(new l.c.Add(c,t)).subscribe((()=>{this.toastr.show({message:"Ruolo aggiunto a "+t,color:"success",action:"Chiudi",duration:5e3})}))}remove(e,t){this.store.dispatch(new l.c.Remove(e,t)).subscribe((()=>{this.toastr.show({message:"Ruolo rimosso da "+t,color:"accent"})}))}_filter(e){const t=e.toLowerCase();return this.allRoles.filter((e=>0===e.description.toLowerCase().indexOf(t)))}}return e.\u0275fac=function(t){return new(t||e)(u.Pb(d.a),u.Pb(b.a),u.Pb(m.b),u.Pb(p.a),u.Pb(d.f),u.Pb(n.e))},e.\u0275cmp=u.Jb({type:e,selectors:[["csl-single-class"]],viewQuery:function(e,t){var i;1&e&&(u.Kc(V,!0),u.Kc(U,!0)),2&e&&(u.rc(i=u.dc())&&(t.roleInput=i.first),u.rc(i=u.dc())&&(t.matAutocomplete=i.first))},decls:2,vars:3,consts:[[4,"ngIf"],[3,"dataSource"],["matColumnDef","email"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","roles"],["matColumnDef","credit"],["matColumnDef","manage"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"chip-list"],["aria-label","Fruit selection"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","Ruoli...",3,"formControl","matAutocomplete","matChipInputFor"],["roleInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"selectable","removable","removed"],["matChipRemove",""],[3,"value"],["mat-button","","color","primary"]],template:function(e,t){1&e&&(u.Dc(0,$,21,4,"ng-container",0),u.hc(1,"async")),2&e&&u.mc("ngIf",u.ic(1,1,t.state$).currentClass)},directives:[f.m,h.a,h.e,h.h,h.d,g.j,g.c,g.e,g.b,g.g,g.i,g.d,g.a,v.b,C.c,f.l,c.b,D.c,C.b,c.o,c.f,D.a,C.a,R.a,C.d,w.i,I.b,g.f,g.h],pipes:[f.b,f.d],styles:[".chip-list[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%}"]}),Object(o.__decorate)([Object(n.c)(l.a),Object(o.__metadata)("design:type",a.a)],e.prototype,"state$",void 0),e})()},CAI7:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var o=i("DY2v"),c=i("+IuD"),a=i.n(c),s=i("w/LV"),r=i.n(s),n=i("6V5p"),l=i.n(n),u=i("UIvY"),d=i.n(u),b=i("eVdK"),m=i.n(b),p=i("jxfh"),f=i("9ufM"),h=i("YtkY"),g=i("8j5Y"),v=i("TLy2"),C=i("EM62"),D=i("sEIs"),R=i("Meci"),w=i("PBFl");let I=(()=>{class e{constructor(e,t,i,o,c){this.commissioni=e,this.dialog=t,this.toastr=i,this.auth=o,this.router=c}ngOnInit(){}ngAfterViewInit(){this.auth.user$.pipe(Object(h.a)((e=>this.router.url.includes("rappre")&&e.isRappre?"comitato":this.router.url.includes("referente")?e.isReferente:void 0)),Object(g.a)((e=>this.commissione=e)),Object(v.a)((e=>this.commissioni.getPage(e)))).subscribe((e=>{const t=e.data;this.editor=new a.a({holder:"editorjs",data:t.page?t.page:null,tools:{header:{class:r.a,shortcut:"CTRL+ALT+T",inlineToolbar:!0,config:{placeholder:"Titolo",levels:[1,2,3],defaultLevel:1}},paragraph:{class:l.a,shortcut:"CTRL+ALT+Q",inlineToolbar:!0,config:{placeholder:"Paragrafo"}},list:{class:d.a,inlineToolbar:!0,shortcut:"CTRL+ALT+W"},image:{class:m.a,shortcut:"CTRL+ALT+I",inlineToolbar:!0,config:{endpoints:{byFile:"/api/commissioni/image"}}}},i18n:{messages:{toolNames:{Text:"Paragrafo",Heading:"Titolo",List:"Elenco",Image:"Immagine",Bold:"Grassetto",Italic:"Corsivo"},tools:{list:{Ordered:"Numerato",Unordered:"Non numerato"},image:{"Select an Image":"Carica un'immagine","With border":"Con bordo","Stretch image":"Allarga immagine","With background":"Con sfondo"},link:{"Add a link":"Aggiungi un link"}},blockTunes:{delete:{Delete:"Elimina"},moveUp:{"Move up":"Sposta su"},moveDown:{"Move down":"Sposta gi\xf9"}},ui:{blockTunes:{toggler:{"Click to tune":"Modifica"}},inlineToolbar:{converter:{"Convert to":"Converti in"}},toolbar:{toolbox:{Add:"Aggiungi"}}}}},defaultBlock:"paragraph",autofocus:!0})}))}save(){this.dialog.open({title:"Salvare pagina?",text:"Potrai tornare quando vorrai per modificarla",answer:"Salva",color:"primary"}).subscribe((()=>{this.editor.save().then((e=>{this.commissioni.savePage(this.commissione,e).subscribe((e=>{e.success?this.toastr.show({color:"success",message:"Pagina salvata"}):this.toastr.showError()}))}))}))}}return e.\u0275fac=function(t){return new(t||e)(C.Pb(o.a),C.Pb(p.a),C.Pb(p.b),C.Pb(f.a),C.Pb(D.f))},e.\u0275cmp=C.Jb({type:e,selectors:[["csl-editor"]],decls:9,vars:0,consts:[["id","editorjs"],[1,"actions"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(C.Vb(0,"mat-card"),C.Vb(1,"mat-card-header"),C.Vb(2,"mat-card-title"),C.Fc(3,"Gestisci la pagina della tua Commissione"),C.Ub(),C.Ub(),C.Vb(4,"mat-card-content"),C.Qb(5,"div",0),C.Ub(),C.Vb(6,"mat-card-actions",1),C.Vb(7,"button",2),C.cc("click",(function(){return t.save()})),C.Fc(8," Salva pagina "),C.Ub(),C.Ub(),C.Ub())},directives:[R.a,R.e,R.h,R.d,R.b,w.b],styles:[".actions[_ngcontent-%COMP%]{margin-left:20px;margin-top:10px}"]}),e})()},r8jD:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var o=i("D57K"),c=i("yDe4"),a=i("oIO+"),s=i("IdLP"),r=i("EM62"),n=i("2kYt"),l=i("Meci"),u=i("sEIs"),d=i("Rjd2");const b=function(e){return[e]};function m(e,t){if(1&e&&(r.Tb(0),r.Vb(1,"mat-card",4),r.Vb(2,"mat-card-header"),r.Vb(3,"mat-card-title"),r.Fc(4),r.Ub(),r.Ub(),r.Ub(),r.Sb()),2&e){const e=t.$implicit;r.Db(1),r.mc("routerLink",r.pc(2,b,e.id)),r.Db(3),r.Gc(e.id)}}function p(e,t){if(1&e&&(r.Vb(0,"div",2),r.Dc(1,m,5,4,"ng-container",3),r.Ub()),2&e){const e=t.ngIf;r.Db(1),r.mc("ngForOf",e)}}function f(e,t){1&e&&(r.Vb(0,"csl-alert",5),r.Fc(1," Non ci sono ancora classi! "),r.Ub())}let h=(()=>{class e{constructor(e){this.store=e}ngOnInit(){this.store.dispatch(new a.b.Get)}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(c.e))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-classi"]],decls:4,vars:4,consts:[["class","cards",4,"ngIf","ngIfElse"],["noClasses",""],[1,"cards"],[4,"ngFor","ngForOf"],[3,"routerLink"],["color","primary"]],template:function(e,t){if(1&e&&(r.Dc(0,p,2,1,"div",0),r.hc(1,"async"),r.Dc(2,f,2,0,"ng-template",null,1,r.Ec)),2&e){const e=r.sc(3);r.mc("ngIf",r.ic(1,2,t.state$).classes)("ngIfElse",e)}},directives:[n.m,n.l,l.a,u.g,l.e,l.h,d.a],pipes:[n.b],styles:[".cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}mat-card[_ngcontent-%COMP%]{cursor:pointer;margin-right:20px;outline:none}"]}),Object(o.__decorate)([Object(c.c)(a.a),Object(o.__metadata)("design:type",s.a)],e.prototype,"state$",void 0),e})()},zlwK:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var o=i("JCQO"),c=i("jxfh"),a=i("EM62"),s=i("PBFl"),r=i("2kYt");function n(e,t){if(1&e){const e=a.Wb();a.Vb(0,"div"),a.Vb(1,"p"),a.Fc(2),a.Ub(),a.Vb(3,"button",4),a.cc("click",(function(){a.uc(e);const t=a.gc();return t.uploadCsv(t.upload.csvFile.name)})),a.Fc(4," Carica "),a.Ub(),a.Ub()}if(2&e){const e=a.gc();a.Db(2),a.Hc('Nome del file caricato: "',e.upload.csvFile.name,'"')}}let l=(()=>{class e{constructor(e,t,i){this.upload=e,this.dialog=t,this.toastr=i}ngOnInit(){}uploadCsv(e){this.dialog.open({title:"Sei sicuro?",text:`Il file "${e}" verr\xe0 caricato e creer\xe0 gli account per gli studenti della scuola`,answer:"Conferma",color:"primary"}).subscribe((e=>{this.upload.onCsvUpload().subscribe((e=>{const{success:t,duplicates:i}=e;!0===t?this.toastr.show({message:"Account creati",color:"success",action:"Chiudi",duration:5e3}):!1===t&&i&&(this.ref=this.toastr.show({message:"Mail duplicate trovate",color:"warn",action:"Copia email",duration:15e3}),this.ref.onAction().subscribe((()=>{window.navigator.clipboard.writeText(i.toString())})))}))}))}}return e.\u0275fac=function(t){return new(t||e)(a.Pb(o.a),a.Pb(c.a),a.Pb(c.b))},e.\u0275cmp=a.Jb({type:e,selectors:[["app-csv"]],decls:6,vars:1,consts:[["type","file",2,"display","none",3,"change"],["selectFile",""],["mat-stroked-button","","color","primary",3,"click"],[4,"ngIf"],["mat-raised-button","","color","primary","size","small",3,"click"]],template:function(e,t){if(1&e){const e=a.Wb();a.Vb(0,"div"),a.Vb(1,"input",0,1),a.cc("change",(function(e){return t.upload.onCsvSelect(e)})),a.Ub(),a.Vb(3,"button",2),a.cc("click",(function(){return a.uc(e),a.sc(2).click()})),a.Fc(4," Scegli file "),a.Ub(),a.Dc(5,n,5,1,"div",3),a.Ub()}2&e&&(a.Db(5),a.mc("ngIf",t.upload.readyToUploadCsv))},directives:[s.b,r.m],styles:["button[_ngcontent-%COMP%]{margin-bottom:20px}"]}),e})()}}]);